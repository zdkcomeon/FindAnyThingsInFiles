<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>文件后缀选择测试</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; }
        .result { background: #f0f0f0; padding: 10px; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>文件后缀选择功能测试</h1>
    
    <div class="test-section">
        <h3>测试1: 基本功能</h3>
        <p>测试 getSelectedExtensions() 函数</p>
        <button onclick="test1()">运行测试1</button>
        <div id="test1-result" class="result"></div>
    </div>
    
    <div class="test-section">
        <h3>测试2: 后缀格式化</h3>
        <p>测试后缀格式化（确保以点开头）</p>
        <button onclick="test2()">运行测试2</button>
        <div id="test2-result" class="result"></div>
    </div>
    
    <script>
        // 模拟全局变量
        let selectedExtensions = new Set();
        
        // 复制主要函数
        function getSelectedExtensions() {
            const customInput = document.getElementById('customExtInput');
            const customInputValue = customInput ? customInput.value.trim() : '';
            const allExts = new Set([...selectedExtensions]);
            
            // 添加自定义输入的后缀
            if (customInputValue) {
                const customExts = customInputValue.split(',').map(ext => ext.trim()).filter(ext => ext);
                customExts.forEach(ext => {
                    if (!ext.startsWith('.')) {
                        ext = '.' + ext;
                    }
                    allExts.add(ext);
                });
            }
            
            return Array.from(allExts).join(',');
        }
        
        function test1() {
            // 重置状态
            selectedExtensions.clear();
            
            // 添加一些后缀
            selectedExtensions.add('.java');
            selectedExtensions.add('.js');
            
            const result = getSelectedExtensions();
            document.getElementById('test1-result').innerHTML = 
                `选中的后缀: ${result}<br>期望: .java,.js<br>结果: ${result === '.java,.js' ? '✅ 通过' : '❌ 失败'}`;
        }
        
        function test2() {
            // 重置状态
            selectedExtensions.clear();
            
            // 创建临时输入框
            const tempInput = document.createElement('input');
            tempInput.id = 'customExtInput';
            tempInput.value = 'py,txt,go';
            document.body.appendChild(tempInput);
            
            const result = getSelectedExtensions();
            const expected = '.py,.txt,.go';
            
            document.getElementById('test2-result').innerHTML = 
                `输入: py,txt,go<br>输出: ${result}<br>期望: ${expected}<br>结果: ${result === expected ? '✅ 通过' : '❌ 失败'}`;
            
            // 清理
            document.body.removeChild(tempInput);
        }
    </script>
</body>
</html>
